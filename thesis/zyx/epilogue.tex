\providecommand{\myrootdir}{..}
\documentclass[\myrootdir/main.tex]{subfiles}

\begin{document}
\appendix{}

\microtypesetup{protrusion=false}

\setlength\cftbeforeloftitleskip{0pt}%
\setlength\cftafterloftitleskip{1em}%
\setlength\cftbeforelottitleskip{2.5em}%
\setlength\cftafterlottitleskip{1em}%

\cleardoublepage
\ifthenelse{\equal{\mylanguage}{de}}{
\pdfbookmark[0]{Abbildungsverzeichnis}{listoffigures}
}{
\pdfbookmark[0]{List of Figures}{listoffigures}
}
\listoffigures{}

\begingroup
% Temporarly overwriting clearpage command
% suppresses a new page for figures and listings
\let\cleardoublepage\relax
\let\clearpage\relax
\vspace{1em}
% Hack to remove ListOfListings from Table of content
\addtocontents{toc}{%
  \edef\protect\SavedTocDepth{\protect\the\protect\value{tocdepth}}%
}%
\addtocontents{toc}{\protect\setcounter{tocdepth}{-10}}
\ifthenelse{\equal{\mylanguage}{de}}{%
\renewcommand{\lstlistlistingname}{Programmverzeichnis\texorpdfstring{\vspace{-0.5em}}{}}
}{%
\renewcommand{\lstlistlistingname}{List of Listings\texorpdfstring{\vspace{-0.5em}}{}}
}
\lstlistoflistings
% End of the Hack to remove ListOfListings from Table of content
\addtocontents{toc}{\protect\setcounter{tocdepth}{\protect\SavedTocDepth}}
\endgroup

\ifthenelse{\equal{\mylanguage}{de}}{
\pdfbookmark[0]{Tabellenverzeichnis}{listoftables}
}{
\pdfbookmark[0]{List of Tables}{listoftables}
}

\listoftables{}
\microtypesetup{protrusion=true}
\cleardoublepage
\sloppy\printbibliography[heading=bibintoc]\fussy
\end{document}
